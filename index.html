<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kaprekar 6174</title>

  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 720px;
      margin: 24px auto;
      padding: 0 16px;
      color: #f5f5f5;
      background: radial-gradient(circle at top, #1e293b, #020617 70%);
    }

    main {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 14px;
      backdrop-filter: blur(6px);
      margin: 16px 0;
    }

    input, button {
      font-size: 16px;
      padding: 10px 12px;
    }

    /* Layout */
    .row {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: nowrap;
    }

    #num {
      flex: 1;
      min-width: 160px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.06);
      color: #f5f5f5;
      outline: none;
    }

    #num::placeholder {
      color: rgba(245,245,245,0.6);
    }

    /* Botones */
    button {
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 12px;
      background: rgba(255,255,255,0.08);
      color: #f5f5f5;
      transition: transform .12s ease, filter .12s ease, background .12s ease;
    }

    button:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    button:active {
      transform: scale(0.98);
    }

    /* Primario */
    #run {
      background: linear-gradient(135deg, rgba(59,130,246,0.7), rgba(99,102,241,0.5));
      border-color: rgba(59,130,246,0.6);
      font-weight: 700;
    }

    /* Secundario */
    #clear {
      background: rgba(255,255,255,0.06);
      opacity: 0.9;
    }

    /* Responsive m√≥vil */
    @media (max-width: 420px){
      .row { flex-wrap: wrap; }
      #num { flex-basis: 100%; }

      #run { flex: 1 1 100%; }

      #clear {
        margin-left: auto;
        width: auto;
      }
    }

    .hint { color: #aaa; margin-top: 10px; }
    .err { color: #ff6b6b; font-weight: 600; }

    #out {
      background: rgba(255,255,255,0.08);
      padding: 12px;
      border-radius: 10px;
      overflow: auto;
      line-height: 1.6;
      word-break: break-word;
      margin-top: 8px;
    }

    /* 6174 */
    .k-final {
      font-size: 1.6em;
      font-weight: 800;
      display: inline-block;
    }

    /* POP inicial */
    .k-pop {
      animation: pop6174 360ms ease-out;
    }

    @keyframes pop6174 {
      0%   { transform: scale(0.85); opacity: 0; }
      60%  { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); }
    }

    /* Latido continuo */
    .k-pulse {
      animation: pulse6174 1.1s ease-in-out infinite;
    }

    @keyframes pulse6174 {
      0%,100% { transform: scale(1); }
      50%     { transform: scale(1.08); }
    }

    /* Mensaje final */
    .k-msg {
      margin-top: 10px;
      font-weight: 700;
    }

    .k-fade {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      animation: fadeMsg 260ms ease-out;
    }

    @keyframes fadeMsg {
      from { opacity: 0; transform: translateY(-2px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <main>
    <h1>Constante de Kaprekar (6174)</h1>

    <p>
      <strong>¬øQu√© es el n√∫mero 6174?</strong><br><br>
      El <strong>6174</strong>, conocido como la <strong>constante de Kaprekar</strong>,
      es un n√∫mero descubierto por D. R. Kaprekar.
    </p>

    <div class="row">
      <input id="num" inputmode="numeric" maxlength="4" placeholder="Ej: 3524" />
      <button id="run">Calcular</button>
      <button id="clear" type="button">Limpiar</button>
    </div>

    <p class="hint">Introduce un n√∫mero de 4 cifras (solo d√≠gitos).</p>
    <p id="msg" class="err"></p>

    <h2>Pasos</h2>
    <div id="out"></div>

    <script>
      function esNumeroDe4Cifras(s) {
        return /^\d{4}$/.test(s);
      }

      function todasIguales(s) {
        return s[0] === s[1] && s[1] === s[2] && s[2] === s[3];
      }

      function pad4(n) {
        return String(n).padStart(4, "0");
      }

      function ordenarAsc(s) {
        return s.split("").sort().join("");
      }

      function ordenarDesc(s) {
        return s.split("").sort().reverse().join("");
      }

      function kaprekarSteps(inputStr) {
        let resultado = parseInt(inputStr, 10);
        const lineas = [];

        do {
          const s = pad4(resultado);
          const menor = ordenarAsc(s);
          const mayor = ordenarDesc(s);

          resultado = parseInt(mayor, 10) - parseInt(menor, 10);

          if (resultado === 6174) {
            lineas.push(`${mayor} - ${menor} = <span class="k-final k-pulse">6174</span>`);
          } else {
            lineas.push(`${mayor} - ${menor} = ${pad4(resultado)}`);
          }
        } while (resultado !== 6174);

        lineas.push(`<div class="k-msg k-fade">Se alcanz√≥ la constante de Kaprekar üò≤</div>`);
        return lineas;
      }

      const $num = document.getElementById("num");
      const $run = document.getElementById("run");
      const $clear = document.getElementById("clear");
      const $out = document.getElementById("out");
      const $msg = document.getElementById("msg");

      function ejecutar() {
        const s = $num.value.trim();
        $msg.textContent = "";
        $out.innerHTML = "";

        if (!esNumeroDe4Cifras(s)) {
          $msg.textContent = "Entrada inv√°lida.";
          return;
        }

        if (todasIguales(s)) {
          $msg.textContent = "Las 4 cifras no pueden ser iguales.";
          return;
        }

        const lineas = kaprekarSteps(s);
        $out.innerHTML = lineas.join("<br>");
      }

      $run.addEventListener("click", ejecutar);

      $clear.addEventListener("click", () => {
        $num.value = "";
        $msg.textContent = "";
        $out.innerHTML = "";
        $num.focus();
      });

      $num.addEventListener("keydown", (e) => {
        if (e.key === "Enter") ejecutar();
      });
    </script>
  </main>
</body>
</html>
