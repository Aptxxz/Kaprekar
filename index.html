<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kaprekar 6174</title>

  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 720px;
      margin: 24px auto;
      padding: 0 16px;
      color: #f5f5f5;
      background: radial-gradient(circle at top, #1e293b, #020617 70%);
    }

    h1 { font-size: clamp(22px, 4.8vw, 34px); }
    
    main {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 14px;
      backdrop-filter: blur(6px);
      margin: 16px 0;
    }

    input, button {
      font-size: 16px;
      padding: 10px 12px;
    }

    /* Layout */
    .row {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: nowrap;
    }

    #num {
      flex: 1;
      min-width: 160px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.06);
      color: #f5f5f5;
      outline: none;
    }

    #num::placeholder {
      color: rgba(245,245,245,0.6);
    }

    /* Botones */
    button {
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 12px;
      background: rgba(255,255,255,0.08);
      color: #f5f5f5;
      transition: transform .12s ease, filter .12s ease, background .12s ease;
    }

    button:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    button:active {
      transform: scale(0.98);
    }

    /* Primario */
    #run {
      background: linear-gradient(135deg, rgba(59,130,246,0.7), rgba(99,102,241,0.5));
      border-color: rgba(59,130,246,0.6);
      font-weight: 700;
    }

    /* Secundario */
    #clear {
      background: rgba(255,255,255,0.06);
      opacity: 0.9;
    }



/* Por defecto (PC) ‚Üí oculto */
#backTop{
  display: none;
}

    /* Responsive m√≥vil */
@media (max-width: 420px){
  .row { flex-wrap: wrap; }
  #num { flex-basis: 100%; }

  #run { flex: 1 1 100%; }

  #clear {
    margin-left: auto;
    width: auto;
  }

  /* Bot√≥n volver arriba visible solo en m√≥vil */
  #backTop{
    display: block;
  }
}



    .hint { color: #aaa; margin-top: 10px; }
    .err { color: #ff6b6b; font-weight: 600; }

    [hidden] { display: none !important; }

    #out {
      background: rgba(255,255,255,0.08);
      padding: 12px;
      border-radius: 10px;
      overflow: auto;
      line-height: 1.6;
      word-break: break-word;
      margin-top: 8px;
    }

    /* 6174 */
    .k-final {
      font-size: 1.6em;
      font-weight: 800;
      display: inline-block;
    }

    /* Latido continuo */
    .k-pulse {
      animation: pulse6174 1.1s ease-in-out infinite;
    }

    @keyframes pulse6174 {
      0%,100% { transform: scale(1); }
      50%     { transform: scale(1.08); }
    }

    /* Mensaje final */
    .k-msg {
      margin-top: 10px;
      font-weight: 700;
    }

    .k-fade {
      display: inline-block;
      animation: fadeMsg 260ms ease-out;
    }

    /* Solo pegamos el emoji al final (no se separa del texto) */
    .k-tail {
      white-space: nowrap;
    }

    @keyframes fadeMsg {
      from { opacity: 0; transform: translateY(-2px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Bot√≥n "volver arriba" */
    .back-top{
      margin-top: 14px;
      width: 100%;
      background: transparent;
      border: 1px dashed rgba(255,255,255,0.25);
      opacity: 0.8;
    }

    .back-top:hover{
      opacity: 1;
    }
  </style>
</head>

<body>
  <main>
    <h1>Constante de Kaprekar (6174)</h1>

    <p>
      <strong>¬øQu√© es el n√∫mero 6174?</strong><br><br>
      El <strong>6174</strong>, conocido como la <strong>constante de Kaprekar</strong>, es un n√∫mero
      sorprendente descubierto por el matem√°tico indio D. R. Kaprekar.
      <br><br>
      Si tomas <strong>cualquier n√∫mero de 4 cifras</strong> (que no tenga todas las cifras iguales)
      y repites este proceso:
    </p>

    <ul>
      <li>Ordenar sus cifras de mayor a menor</li>
      <li>Ordenarlas de menor a mayor</li>
      <li>Restar el n√∫mero menor al mayor</li>
    </ul>

    <p>
      En pocos pasos <strong>siempre terminar√°s llegando a 6174</strong>.<br>
      Prueba con cualquier n√∫mero v√°lido y observa c√≥mo el proceso converge autom√°ticamente.
    </p>

    <div class="row">
      <input id="num" inputmode="numeric" maxlength="4" placeholder="Ej: 3524" />
      <button id="run">Calcular</button>
      <button id="clear" type="button">Limpiar</button>
    </div>

    <p class="hint">Introduce un n√∫mero de 4 cifras (solo d√≠gitos).</p>
    <p id="msg" class="err"></p>

    <section id="stepsWrap" hidden>
      <h2>Pasos</h2>
      <div id="out"></div>

      <button id="backTop" type="button" class="back-top">‚Üë Probar otro n√∫mero</button>
    </section>

    <script>
      function esNumeroDe4Cifras(s) {
        return /^\d{4}$/.test(s);
      }

      function todasIguales(s) {
        return s[0] === s[1] && s[1] === s[2] && s[2] === s[3];
      }

      function pad4(n) {
        return String(n).padStart(4, "0");
      }

      function ordenarAsc(s) {
        return s.split("").sort().join("");
      }

      function ordenarDesc(s) {
        return s.split("").sort().reverse().join("");
      }

      function kaprekarSteps(inputStr) {
        let resultado = parseInt(inputStr, 10);
        const lineas = [];

        do {
          const s = pad4(resultado);
          const menor = ordenarAsc(s);
          const mayor = ordenarDesc(s);

          resultado = parseInt(mayor, 10) - parseInt(menor, 10);

          if (resultado === 6174) {
            lineas.push(`${mayor} - ${menor} = <span class="k-final k-pulse">6174</span>`);
          } else {
            lineas.push(`${mayor} - ${menor} = ${pad4(resultado)}`);
          }
        } while (resultado !== 6174);

        lineas.push(`<div class="k-msg k-fade">Se alcanz√≥ la constante <span class="k-tail">de Kaprekar üò≤</span></div>`);
        return lineas;
      }

      const $num = document.getElementById("num");
      const $run = document.getElementById("run");
      const $clear = document.getElementById("clear");
      const $out = document.getElementById("out");
      const $msg = document.getElementById("msg");
      const $stepsWrap = document.getElementById("stepsWrap");
      const $backTop = document.getElementById("backTop");

      function ejecutar() {
        const s = $num.value.trim();
        $msg.textContent = "";
        $out.innerHTML = "";
        $stepsWrap.hidden = true;

        if (!esNumeroDe4Cifras(s)) {
          $msg.textContent = "Entrada inv√°lida.";
          return;
        }

        if (todasIguales(s)) {
          $msg.textContent = "Las 4 cifras no pueden ser iguales.";
          return;
        }

        const lineas = kaprekarSteps(s);
        $stepsWrap.hidden = false;
        $out.innerHTML = lineas.join("<br>");

        requestAnimationFrame(() => {
          $stepsWrap.scrollIntoView({ behavior: "smooth", block: "start" });
        });
      }

      $run.addEventListener("click", ejecutar);

      $clear.addEventListener("click", () => {
        $num.value = "";
        $msg.textContent = "";
        $out.innerHTML = "";
        $stepsWrap.hidden = true;
        $num.focus();
      });

      $num.addEventListener("keydown", (e) => {
        if (e.key === "Enter") ejecutar();
      });

      $backTop.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
        $num.focus();
      });
    </script>
  </main>
</body>
</html>
